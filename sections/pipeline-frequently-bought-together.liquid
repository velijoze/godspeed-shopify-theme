{% comment %}
  Custom – Pipeline Frequently Bought Together
  Displays recommended complementary products with simple add-to-cart.
{% endcomment %}

<section class="section-{{ section.id }}-padding pipeline-fbt" id="PipelineFBT-{{ section.id }}">
  <div class="page-width">
    {% if section.settings.heading != blank %}
      <h2 class="h2">{{ section.settings.heading }}</h2>
      {% if section.settings.subtitle != blank %}
        <p class="subtext">{{ section.settings.subtitle }}</p>
      {% endif %}
    {% endif %}

    <div class="grid grid--2-col-tablet grid--4-col-desktop">
      {% assign handles = section.settings.bundle_products | split: ',' %}
      {% for h in handles %}
        {% assign trimmed = h | strip %}
        {% assign p = all_products[trimmed] %}
        {% if p %}
        <div class="grid__item">
          {% render 'card-product-pipeline', product: p %}
        </div>
        {% endif %}
      {% endfor %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "Custom – Pipeline Frequently Bought Together",
  "settings": [
    { "type": "text", "id": "heading", "label": "Heading", "default": "Frequently bought together" },
    { "type": "text", "id": "subtitle", "label": "Subtitle", "default": "Complete your setup" },
    { "type": "text", "id": "bundle_products", "label": "Product handles (comma-separated)", "default": "" },
    { "type": "range", "id": "padding_top", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Top padding", "default": 48 },
    { "type": "range", "id": "padding_bottom", "min": 0, "max": 100, "step": 4, "unit": "px", "label": "Bottom padding", "default": 48 }
  ],
  "presets": [
    { "name": "Custom – Pipeline Frequently Bought Together" }
  ]
}
{% endschema %}

